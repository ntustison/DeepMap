

## Quicksilver

* Quicksilver uses a patch-based approach to predict the "momentum" of the LDDMM framework
in determinining the correspondence relationship between fixed and moving image patch pairs.

    * The large deformation diffeomorphic metric mappings (LDDMM) framework for image matching
      stems from the theoretical foundations underlying diffeomorphic *flows*
      ([@Trouve:1995aa;@Christensen:1996aa;@Dupuis:1998]), or transformations which are
      differentiable with differentiable inverses.  The collection of *paths* between two
      images which describe the possible mappings between images is described by the\
      functional (equation here) XX.

    * Computationally efficient algorithms for solving such diffeomorphic flows have been subsequently proposed
      (e.g., [@Beg:2005aa;@Ashburner:2007aa;@Avants:2008aa;@Vercauteren:2009aa;@Vialard:2012aa;@Zhang:2017aa]).

    * The Euler-Lagrange equation for the functional XX can be written as a system of equations
      which incorporates a "momentum" term,
      $m_{t} = Jac\left( \phi^v_{t,1} \right)\left( I \circ \phi_{t,0} - J \circ \phi_{t,1} \right)$.
      Several algorithms (e.g., [@Beg:2005aa;@Vialard:2012aa]) take advantage of the fact that the initial momentum, $m_0$,
      completely encodes the optimum path describing the transform between images $I$ and $J$.

    * Following [@Miller:2006aa], the initial momentum is calculated from the equation
      $m\left(x, 0\right) = \alpha\left(x, 0\right) \nabla I_0$ where $\alpha$ is a time-varying
      scalar field function and $\nabla I_0$ is the spatial derivative of the image $I$.

    * In costrast to scalar formulations of the momenta (e.g., [@Vialard:2012aa]), a vector formulation
      is proposed in [@Singh:2013aa], to avoid potential confounding effects of noise in the image
      gradient (i.e., better behaved numerically).

    * The prediction network is used to estimate the vector momentum

* Network architecture

    * Eencoder/decoder structure for performing voxelwise image regression.

    * There are two separate encoders---one for the fixed image and one for the moving image.

    *

    * $15 \times 15 \times 15$ patches selected at stride = 14.

* Thus, Quicksilver is a supervised approach wherein it uses multiple image pairs
and the corresponding ground-truth estimations of the momentum scalar maps to perform
prediction of momentum on unseen image pairs (but patch-based).

* Written in pytorch?  (torch (facebook) in python) and available at

* Misc. notes

    * Initial momentum is not generally smooth so smoothing is applied after prediction

    * Training data employed regular LDDMM shooting results using PyCA (page 385)

    * They also use dropout layers to induce a probabilistic network

    * They also train a correction network (Section 2.3).  THe prediction ---> correction
      networks is diagrammed in Figure 3.

    * The PyCA LDDMM, prediction, and prediction + correction are included in the evaluation.

    * Preprocessing:

        * Skull-striping (FreeSurfer and AutoSeg)

        * Initial affine registration --- NiftyReg
